# Day 10 练习题：项目完善
> 要求：独立完成以下练习，巩固配置管理、分页和验证
>

---

## 练习 1：updated_at 自动更新
```plain
完成以下任务：

1. 为 User 模型添加 updated_at 字段
2. 使用 onupdate=datetime.utcnow 实现自动更新
3. 更新 to_dict() 返回 updated_at
4. 测试：创建用户后修改信息，确认 updated_at 自动变化

测试步骤：
- 创建用户，记录 created_at 和 updated_at
- 等待几秒后修改用户信息
- 确认 updated_at 已更新，created_at 不变
```

---

## 练习 2：分页接口
```plain
为用户列表接口实现完整分页功能：

1. 支持参数：
   - page：页码（默认 1）
   - size：每页数量（默认 10，最大 100）
   - sort：排序字段（created_at / username）
   - order：排序方向（asc / desc，默认 desc）

2. 返回格式：
   {
       "code": 0,
       "data": {
           "list": [...],
           "total": 50,
           "page": 1,
           "pages": 5,
           "size": 10
       }
   }

3. 创建 20 个测试用户，验证分页功能

提示：
- 使用 getattr(User, sort_field) 动态获取排序字段
```

---

## 练习 3：注册验证
```plain
完善注册接口的验证逻辑：

1. 用户名：
   - 长度 2-50
   - 只能包含字母、数字、下划线

2. 邮箱：
   - 必须包含 @
   - 不能重复

3. 密码：
   - 长度至少 6 位
   - 必须包含数字和字母

4. 编写验证函数，测试以下用例：
   - 空用户名 -> 错误
   - 用户名 "a" -> 长度不足
   - 用户名 "user@name" -> 包含非法字符
   - 邮箱 "invalid" -> 格式错误
   - 密码 "123" -> 长度不足
   - 密码 "123456" -> 缺少字母
   - 全部合法 -> 注册成功
```

---

## 完成检查
- [ ] updated_at 字段能自动更新
- [ ] 分页接口返回正确的分页信息
- [ ] 注册验证覆盖了所有情况
- [ ] 所有接口测试通过

---
